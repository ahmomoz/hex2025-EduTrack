import{_ as j,K as B,r as h,p as $,x as W,c as r,a as s,t as g,k as o,d as O,a2 as V,a3 as H,a4 as G,a5 as z,R as D,S as R,a6 as T,a7 as b,o as l,O as X}from"./GIYmCKSs.js";function J(x,E,c,t,_="2025-05-01"){const u=new Date(_),n=E.reduce((p,a)=>{const e=new Date(a.date);return e>p?e:p},u),P=Math.floor((n-u)/(1e3*60*60*24))+1,f=Array.from({length:P},(p,a)=>{const e=new Date(u);return e.setDate(u.getDate()+a),e.toISOString().slice(0,10)}),v=x.map(p=>{const a=f.map(e=>{var C;return!!((C=p.presence)!=null&&C[e])});return{author_id:p.author_id,global_name:p.global_name,username:p.username,days:a}});return{dateList:f,processedUsers:v,pagination:c,updatedAt:t}}const Y=x=>new Date(x).toLocaleDateString("zh-TW",{year:"numeric",month:"2-digit",day:"2-digit"});var Q={ALLUSERSPROFILE:"C:\\ProgramData",API_BASE_URL:"https://hex2025.onrender.com/api",APPDATA:"C:\\Users\\x5426\\AppData\\Roaming",CHROME_CRASHPAD_PIPE_NAME:"\\\\.\\pipe\\crashpad_14852_SRSFFVRLMEDSWBOW",COLOR:"1",COLORTERM:"truecolor",CommonProgramFiles:"C:\\Program Files\\Common Files","CommonProgramFiles(x86)":"C:\\Program Files (x86)\\Common Files",CommonProgramW6432:"C:\\Program Files\\Common Files",COMPUTERNAME:"DESKTOP-K1CR84R",ComSpec:"C:\\Windows\\system32\\cmd.exe",DriverData:"C:\\Windows\\System32\\Drivers\\DriverData",EDITOR:"C:\\Windows\\notepad.exe",FPS_BROWSER_APP_PROFILE_STRING:"Internet Explorer",FPS_BROWSER_USER_PROFILE_STRING:"Default",GIT_ASKPASS:"c:\\Users\\x5426\\AppData\\Local\\Programs\\Microsoft VS Code\\resources\\app\\extensions\\git\\dist\\askpass.sh",HOME:"C:\\Users\\x5426",HOMEDRIVE:"C:",HOMEPATH:"\\Users\\x5426",INIT_CWD:"C:\\Program Files\\Nuxt\\hex2025-EduTrack",KMP_BLOCKTIME:"0",LANG:"zh_TW.UTF-8",LOCALAPPDATA:"C:\\Users\\x5426\\AppData\\Local",LOGONSERVER:"\\\\DESKTOP-K1CR84R",NODE:"C:\\Program Files\\nodejs\\node.exe",NODE_ENV:"production",NODE_EXE:"C:\\Program Files\\nodejs\\\\node.exe",NPM_CLI_JS:"C:\\Program Files\\nodejs\\\\node_modules\\npm\\bin\\npm-cli.js",npm_command:"run-script",npm_config_cache:"C:\\Users\\x5426\\AppData\\Local\\npm-cache",npm_config_globalconfig:"C:\\Users\\x5426\\AppData\\Roaming\\npm\\etc\\npmrc",npm_config_global_prefix:"C:\\Users\\x5426\\AppData\\Roaming\\npm",npm_config_init_module:"C:\\Users\\x5426\\.npm-init.js",npm_config_local_prefix:"C:\\Program Files\\Nuxt\\hex2025-EduTrack",npm_config_metrics_registry:"https://registry.npmjs.org/",npm_config_node_gyp:"C:\\Users\\x5426\\AppData\\Roaming\\nvm\\v18.16.0\\node_modules\\npm\\node_modules\\node-gyp\\bin\\node-gyp.js",npm_config_noproxy:"",npm_config_prefix:"C:\\Users\\x5426\\AppData\\Roaming\\npm",npm_config_userconfig:"C:\\Users\\x5426\\.npmrc",npm_config_user_agent:"npm/9.5.1 node/v18.16.0 win32 x64 workspaces/false",npm_execpath:"C:\\Users\\x5426\\AppData\\Roaming\\nvm\\v18.16.0\\node_modules\\npm\\bin\\npm-cli.js",npm_lifecycle_event:"generate",npm_lifecycle_script:"nuxt generate",npm_node_execpath:"C:\\Program Files\\nodejs\\node.exe",npm_package_json:"C:\\Program Files\\Nuxt\\hex2025-EduTrack\\package.json",npm_package_name:"nuxt-app",NPM_PREFIX_NPM_CLI_JS:"C:\\Users\\x5426\\AppData\\Roaming\\npm\\node_modules\\npm\\bin\\npm-cli.js",NUMBER_OF_PROCESSORS:"8",NVM_HOME:"C:\\Users\\x5426\\AppData\\Roaming\\nvm",NVM_SYMLINK:"C:\\Program Files\\nodejs",OMP_WAIT_POLICY:"PASSIVE",OneDrive:"C:\\Users\\x5426\\OneDrive",OneDriveConsumer:"C:\\Users\\x5426\\OneDrive",ORIGINAL_XDG_CURRENT_DESKTOP:"undefined",OS:"Windows_NT",Path:"C:\\Program Files\\Nuxt\\hex2025-EduTrack\\node_modules\\.bin;C:\\Program Files\\Nuxt\\node_modules\\.bin;C:\\Program Files\\node_modules\\.bin;C:\\node_modules\\.bin;C:\\Users\\x5426\\AppData\\Roaming\\nvm\\v18.16.0\\node_modules\\npm\\node_modules\\@npmcli\\run-script\\lib\\node-gyp-bin;C:\\Windows\\system32;C:\\Windows;C:\\Windows\\System32\\Wbem;C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\;C:\\Windows\\System32\\OpenSSH\\;C:\\Program Files\\dotnet\\;C:\\Program Files\\Git\\cmd;C:\\Users\\x5426\\AppData\\Roaming\\nvm;C:\\Program Files\\nodejs;C:\\Windows\\System32\\Wbem;C:\\Program Files\\Docker\\Docker\\resources\\bin;C:\\Program Files\\PuTTY\\;C:\\Users\\x5426\\AppData\\Local\\Programs\\Python\\Python313\\Scripts\\;C:\\Users\\x5426\\AppData\\Local\\Programs\\Python\\Python313\\;C:\\Users\\x5426\\AppData\\Local\\Programs\\Python\\Launcher\\;C:\\Users\\x5426\\AppData\\Local\\Microsoft\\WindowsApps;C:\\Users\\x5426\\.dotnet\\tools;C:\\Users\\x5426\\AppData\\Roaming\\npm;C:\\Users\\x5426\\AppData\\Roaming\\nvm;C:\\Program Files\\nodejs;C:\\Users\\x5426\\AppData\\Local\\Programs\\Microsoft VS Code\\bin;C:\\Program Files (x86)\\ngrok;",PATHEXT:".COM;.EXE;.BAT;.CMD;.VBS;.VBE;.JS;.JSE;.WSF;.WSH;.MSC;.CPL",PROCESSOR_ARCHITECTURE:"AMD64",PROCESSOR_IDENTIFIER:"Intel64 Family 6 Model 94 Stepping 3, GenuineIntel",PROCESSOR_LEVEL:"6",PROCESSOR_REVISION:"5e03",ProgramData:"C:\\ProgramData",ProgramFiles:"C:\\Program Files","ProgramFiles(x86)":"C:\\Program Files (x86)",ProgramW6432:"C:\\Program Files",PROMPT:"$P$G",PSModulePath:"C:\\Users\\x5426\\OneDrive\\文件\\WindowsPowerShell\\Modules;C:\\Program Files\\WindowsPowerShell\\Modules;C:\\Windows\\system32\\WindowsPowerShell\\v1.0\\Modules",PUBLIC:"C:\\Users\\Public",SESSIONNAME:"Console",SystemDrive:"C:",SystemRoot:"C:\\Windows",TEMP:"C:\\Users\\x5426\\AppData\\Local\\Temp",TERM_PROGRAM:"vscode",TERM_PROGRAM_VERSION:"1.99.3",TMP:"C:\\Users\\x5426\\AppData\\Local\\Temp",USERDOMAIN:"DESKTOP-K1CR84R",USERDOMAIN_ROAMINGPROFILE:"DESKTOP-K1CR84R",USERNAME:"x5426",USERPROFILE:"C:\\Users\\x5426",VSCODE_GIT_ASKPASS_EXTRA_ARGS:"",VSCODE_GIT_ASKPASS_MAIN:"c:\\Users\\x5426\\AppData\\Local\\Programs\\Microsoft VS Code\\resources\\app\\extensions\\git\\dist\\askpass-main.js",VSCODE_GIT_ASKPASS_NODE:"C:\\Users\\x5426\\AppData\\Local\\Programs\\Microsoft VS Code\\Code.exe",VSCODE_GIT_IPC_HANDLE:"\\\\.\\pipe\\vscode-git-7af9e1cdba-sock",VSCODE_INJECTION:"1",windir:"C:\\Windows",ZES_ENABLE_SYSMAN:"1"};const Z={class:"container-fluid py-4 height-100vh"},q={class:"card shadow mt-4"},ee={class:"card-body container-fluid pt-3"},se={class:"row"},ae={class:"col"},oe={class:"p-0"},te={class:"m-0"},ne={class:"row f-between-center"},ie={class:"col-sm-6 col-xxl-2"},re={class:"dataTables_length",id:"dataTable_length"},le={class:"f-center gap-2"},de={class:"col-sm-6 col-xxl-3 mt-2 mt-sm-0"},pe={id:"dataTable_filter",class:"dataTables_filter text-end"},me={class:"f-center gap-2"},ce={class:"table-responsive mt-3"},_e={key:0,class:"table table-bordered table-hover",id:"dataTable",width:"100%",cellspacing:"0"},ue={class:"table-light"},ge=["title"],Ce={class:"text-center"},Pe={key:0,class:"fas fa-solid fa-check text-success"},Se={key:1,class:"py-4"},he={key:2,class:"py-4"},xe={class:"row f-between-center mt-2"},Ee={class:"col-sm-6"},fe={class:"dataTables_info",id:"dataTable_info",role:"status","aria-live":"polite"},De={class:"col-sm-6 mt-2 mt-sm-0"},Re={class:"f-md-end-center"},ve={class:"pagination"},Ae=["onClick"],Oe={key:1,class:"page-link"},Te={__name:"index",setup(x){const{$swal:E}=B(),c=h(""),t=h(1),_=h(10),u=h(null),n=h(null),P=async()=>{try{const a=await $fetch(`${Q.API_BASE_URL}/dashboard/?page=${t.value}&page_size=${_.value}&search=${c.value}`);n.value=J(a.users,a.stats,a.pagination,a.updated_at,"2025-05-01")}catch(a){E.fire({position:"center",icon:"error",title:(a==null?void 0:a.data)||"發生未知錯誤，請稍後重試",showConfirmButton:!1,timer:1500})}},f=()=>{clearTimeout(u.value),u.value=setTimeout(()=>{t.value=1,P()},300)};$(()=>P()),W([t,_],()=>P()),W(c,f);const v=a=>{const e=[];if(a<=5)for(let d=1;d<=a;d++)e.push(d);else if(t.value<=3){for(let d=1;d<=4;d++)e.push(d);e.push("..."),e.push(a)}else if(t.value>=a-2){e.push(1),e.push("...");for(let d=a-3;d<=a;d++)e.push(d)}else e.push(1),e.push("..."),e.push(t.value-1),e.push(t.value),e.push(t.value+1),e.push("..."),e.push(a);return e},p=a=>{t.value=a};return(a,e)=>{var C,d,M,U,y,I,F,L,N,w;return l(),r("div",Z,[e[17]||(e[17]=s("h1",{class:"h3 mb-2 text-gray-800"},"Tables",-1)),s("div",q,[e[16]||(e[16]=s("div",{class:"card-header py-3"},[s("h2",{class:"fs-5 m-0 text-primary"},"每日任務打卡狀況")],-1)),s("div",ee,[s("div",se,[s("div",ae,[s("ol",oe,[e[5]||(e[5]=s("li",null,[s("p",{class:"m-0"},"*只要在該日打卡討論串留言就算打卡成功")],-1)),s("li",null,[s("p",te," *資料更新頻率：一個小時更新一次（最後更新時間： "+g((C=o(n))==null?void 0:C.updatedAt)+"） ",1)])])])]),s("div",ne,[s("div",ie,[s("div",re,[s("label",le,[e[7]||(e[7]=O(" Show ")),V(s("select",{name:"dataTable_length","aria-controls":"dataTable",class:"form-control form-control-sm","onUpdate:modelValue":e[0]||(e[0]=i=>G(_)?_.value=i:null),onChange:e[1]||(e[1]=i=>t.value=1)},e[6]||(e[6]=[s("option",{value:"10"},"10",-1),s("option",{value:"25"},"25",-1),s("option",{value:"50"},"50",-1),s("option",{value:"100"},"100",-1)]),544),[[H,o(_)]]),e[8]||(e[8]=O(" entries "))])])]),s("div",de,[s("div",pe,[s("label",me,[e[9]||(e[9]=O(" Search: ")),V(s("input",{type:"search",class:"form-control form-control-sm",placeholder:"請輸入顯示名稱","aria-controls":"dataTable","onUpdate:modelValue":e[2]||(e[2]=i=>G(c)?c.value=i:null)},null,512),[[z,o(c)]])])])])]),s("div",ce,[((d=o(n))==null?void 0:d.processedUsers.length)>0?(l(),r("table",_e,[s("thead",ue,[s("tr",null,[e[10]||(e[10]=s("th",null,"使用者名稱",-1)),e[11]||(e[11]=s("th",null,"累積打卡天數",-1)),(l(!0),r(D,null,R((M=o(n))==null?void 0:M.dateList,(i,m)=>(l(),r("th",{key:m,title:o(Y)(i)}," Day "+g(m+1),9,ge))),128))])]),s("tbody",null,[(l(!0),r(D,null,R((U=o(n))==null?void 0:U.processedUsers,({global_name:i,author_id:m,username:S,days:k})=>(l(),r("tr",{key:m},[s("td",null,g(i)+" ("+g(S)+")",1),s("td",Ce,g(k.filter(A=>A).length),1),(l(!0),r(D,null,R(k,(A,K)=>(l(),r("td",{key:K,class:"text-center"},[A?(l(),r("i",Pe)):X("",!0)]))),128))]))),128))])])):((y=o(n))==null?void 0:y.processedUsers.length)===0?(l(),r("div",Se,e[12]||(e[12]=[s("h2",{class:"fs-5 fs-lg-2"},"無符合搜尋結果的資料",-1)]))):(l(),r("div",he,e[13]||(e[13]=[s("h2",{class:"fs-5 fs-lg-2"},"載入中 ...",-1)])))]),s("div",xe,[s("div",Ee,[s("div",fe,g((I=o(n))!=null&&I.pagination?`Showing ${(o(n).pagination.current_page-1)*o(n).pagination.page_size+1} 
          to ${Math.min(o(n).pagination.current_page*o(n).pagination.page_size,o(n).pagination.total_count)} 
          of ${o(n).pagination.total_count} entries`:"Loading..."),1)]),s("div",De,[s("div",Re,[s("ul",ve,[s("li",{class:T(["paginate_button page-item previous",{disabled:o(t)===1}])},[s("a",{href:"#","aria-controls":"dataTable",class:"page-link",onClick:e[3]||(e[3]=b(i=>o(t)>1&&p(o(t)-1),["prevent"]))},e[14]||(e[14]=[s("i",{class:"fas fa-solid fa-angle-left"},null,-1)]))],2),(l(!0),r(D,null,R(v((L=(F=o(n))==null?void 0:F.pagination)==null?void 0:L.total_pages),(i,m)=>(l(),r("li",{class:T(["paginate_button page-item",{active:i===o(t),disabled:i==="..."}]),key:m},[i!=="..."?(l(),r("a",{key:0,href:"#","aria-controls":"dataTable",class:"page-link",onClick:b(S=>p(i),["prevent"])},g(i),9,Ae)):(l(),r("span",Oe,"..."))],2))),128)),s("li",{class:T(["paginate_button page-item next",{disabled:o(t)===((w=(N=o(n))==null?void 0:N.pagination)==null?void 0:w.total_pages)}]),id:"dataTable_next"},[s("a",{href:"#","aria-controls":"dataTable",class:"page-link",onClick:e[4]||(e[4]=b(i=>{var m,S;return o(t)<((S=(m=o(n))==null?void 0:m.pagination)==null?void 0:S.total_pages)&&p(o(t)+1)},["prevent"]))},e[15]||(e[15]=[s("i",{class:"fas fa-solid fa-angle-right"},null,-1)]))],2)])])])])])])])}}},Me=j(Te,[["__scopeId","data-v-1b26bc92"]]);export{Me as default};
