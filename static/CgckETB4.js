import{_ as B,K as $,r as S,p as H,x as w,c as l,a as s,t as _,k as a,d as A,a2 as k,a3 as z,a4 as W,a5 as X,R as D,S as R,a6 as O,a7 as T,o as d,O as J}from"./BHiYGstk.js";function Y(x,f,m,n,u,h="2025-05-01"){const t=new Date(h),g=f.reduce((o,e)=>{const p=new Date(e.date);return p>o?p:o},t),v=Math.floor((g-t)/(1e3*60*60*24))+1,E=Array.from({length:v},(o,e)=>{const p=new Date(t);return p.setDate(t.getDate()+e),p.toISOString().slice(0,10)}),C=x.map(o=>{const e=E.map(p=>{var i;return!!((i=o.presence)!=null&&i[p])});return{author_id:o.author_id,global_name:o.global_name,username:o.username,completed_count:o.completed_count,days:e}});return{dateList:E,processedUsers:C,pagination:m,updatedAt:n}}const Q=x=>new Date(x).toLocaleDateString("zh-TW",{year:"numeric",month:"2-digit",day:"2-digit"});var Z={ALLUSERSPROFILE:"C:\\ProgramData",API_BASE_URL:"https://hex2025.onrender.com/api",APPDATA:"C:\\Users\\x5426\\AppData\\Roaming",CHROME_CRASHPAD_PIPE_NAME:"\\\\.\\pipe\\crashpad_14852_SRSFFVRLMEDSWBOW",COLOR:"1",COLORTERM:"truecolor",CommonProgramFiles:"C:\\Program Files\\Common Files","CommonProgramFiles(x86)":"C:\\Program Files (x86)\\Common Files",CommonProgramW6432:"C:\\Program Files\\Common Files",COMPUTERNAME:"DESKTOP-K1CR84R",ComSpec:"C:\\Windows\\system32\\cmd.exe",DriverData:"C:\\Windows\\System32\\Drivers\\DriverData",EDITOR:"C:\\Windows\\notepad.exe",FPS_BROWSER_APP_PROFILE_STRING:"Internet Explorer",FPS_BROWSER_USER_PROFILE_STRING:"Default",GIT_ASKPASS:"c:\\Users\\x5426\\AppData\\Local\\Programs\\Microsoft VS Code\\resources\\app\\extensions\\git\\dist\\askpass.sh",HOME:"C:\\Users\\x5426",HOMEDRIVE:"C:",HOMEPATH:"\\Users\\x5426",INIT_CWD:"C:\\Program Files\\Nuxt\\hex2025-EduTrack",KMP_BLOCKTIME:"0",LANG:"zh_TW.UTF-8",LOCALAPPDATA:"C:\\Users\\x5426\\AppData\\Local",LOGONSERVER:"\\\\DESKTOP-K1CR84R",NODE:"C:\\Program Files\\nodejs\\node.exe",NODE_ENV:"production",NODE_EXE:"C:\\Program Files\\nodejs\\\\node.exe",NPM_CLI_JS:"C:\\Program Files\\nodejs\\\\node_modules\\npm\\bin\\npm-cli.js",npm_command:"run-script",npm_config_cache:"C:\\Users\\x5426\\AppData\\Local\\npm-cache",npm_config_globalconfig:"C:\\Users\\x5426\\AppData\\Roaming\\npm\\etc\\npmrc",npm_config_global_prefix:"C:\\Users\\x5426\\AppData\\Roaming\\npm",npm_config_init_module:"C:\\Users\\x5426\\.npm-init.js",npm_config_local_prefix:"C:\\Program Files\\Nuxt\\hex2025-EduTrack",npm_config_metrics_registry:"https://registry.npmjs.org/",npm_config_node_gyp:"C:\\Users\\x5426\\AppData\\Roaming\\nvm\\v18.16.0\\node_modules\\npm\\node_modules\\node-gyp\\bin\\node-gyp.js",npm_config_noproxy:"",npm_config_prefix:"C:\\Users\\x5426\\AppData\\Roaming\\npm",npm_config_userconfig:"C:\\Users\\x5426\\.npmrc",npm_config_user_agent:"npm/9.5.1 node/v18.16.0 win32 x64 workspaces/false",npm_execpath:"C:\\Users\\x5426\\AppData\\Roaming\\nvm\\v18.16.0\\node_modules\\npm\\bin\\npm-cli.js",npm_lifecycle_event:"generate",npm_lifecycle_script:"nuxt generate",npm_node_execpath:"C:\\Program Files\\nodejs\\node.exe",npm_package_json:"C:\\Program Files\\Nuxt\\hex2025-EduTrack\\package.json",npm_package_name:"nuxt-app",NPM_PREFIX_NPM_CLI_JS:"C:\\Users\\x5426\\AppData\\Roaming\\npm\\node_modules\\npm\\bin\\npm-cli.js",NUMBER_OF_PROCESSORS:"8",NVM_HOME:"C:\\Users\\x5426\\AppData\\Roaming\\nvm",NVM_SYMLINK:"C:\\Program Files\\nodejs",OMP_WAIT_POLICY:"PASSIVE",OneDrive:"C:\\Users\\x5426\\OneDrive",OneDriveConsumer:"C:\\Users\\x5426\\OneDrive",ORIGINAL_XDG_CURRENT_DESKTOP:"undefined",OS:"Windows_NT",Path:"C:\\Program Files\\Nuxt\\hex2025-EduTrack\\node_modules\\.bin;C:\\Program Files\\Nuxt\\node_modules\\.bin;C:\\Program Files\\node_modules\\.bin;C:\\node_modules\\.bin;C:\\Users\\x5426\\AppData\\Roaming\\nvm\\v18.16.0\\node_modules\\npm\\node_modules\\@npmcli\\run-script\\lib\\node-gyp-bin;C:\\Windows\\system32;C:\\Windows;C:\\Windows\\System32\\Wbem;C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\;C:\\Windows\\System32\\OpenSSH\\;C:\\Program Files\\dotnet\\;C:\\Program Files\\Git\\cmd;C:\\Users\\x5426\\AppData\\Roaming\\nvm;C:\\Program Files\\nodejs;C:\\Windows\\System32\\Wbem;C:\\Program Files\\Docker\\Docker\\resources\\bin;C:\\Program Files\\PuTTY\\;C:\\Users\\x5426\\AppData\\Local\\Programs\\Python\\Python313\\Scripts\\;C:\\Users\\x5426\\AppData\\Local\\Programs\\Python\\Python313\\;C:\\Users\\x5426\\AppData\\Local\\Programs\\Python\\Launcher\\;C:\\Users\\x5426\\AppData\\Local\\Microsoft\\WindowsApps;C:\\Users\\x5426\\.dotnet\\tools;C:\\Users\\x5426\\AppData\\Roaming\\npm;C:\\Users\\x5426\\AppData\\Roaming\\nvm;C:\\Program Files\\nodejs;C:\\Users\\x5426\\AppData\\Local\\Programs\\Microsoft VS Code\\bin;C:\\Program Files (x86)\\ngrok;",PATHEXT:".COM;.EXE;.BAT;.CMD;.VBS;.VBE;.JS;.JSE;.WSF;.WSH;.MSC;.CPL",PROCESSOR_ARCHITECTURE:"AMD64",PROCESSOR_IDENTIFIER:"Intel64 Family 6 Model 94 Stepping 3, GenuineIntel",PROCESSOR_LEVEL:"6",PROCESSOR_REVISION:"5e03",ProgramData:"C:\\ProgramData",ProgramFiles:"C:\\Program Files","ProgramFiles(x86)":"C:\\Program Files (x86)",ProgramW6432:"C:\\Program Files",PROMPT:"$P$G",PSModulePath:"C:\\Users\\x5426\\OneDrive\\文件\\WindowsPowerShell\\Modules;C:\\Program Files\\WindowsPowerShell\\Modules;C:\\Windows\\system32\\WindowsPowerShell\\v1.0\\Modules",PUBLIC:"C:\\Users\\Public",SESSIONNAME:"Console",SystemDrive:"C:",SystemRoot:"C:\\Windows",TEMP:"C:\\Users\\x5426\\AppData\\Local\\Temp",TERM_PROGRAM:"vscode",TERM_PROGRAM_VERSION:"1.99.3",TMP:"C:\\Users\\x5426\\AppData\\Local\\Temp",USERDOMAIN:"DESKTOP-K1CR84R",USERDOMAIN_ROAMINGPROFILE:"DESKTOP-K1CR84R",USERNAME:"x5426",USERPROFILE:"C:\\Users\\x5426",VSCODE_GIT_ASKPASS_EXTRA_ARGS:"",VSCODE_GIT_ASKPASS_MAIN:"c:\\Users\\x5426\\AppData\\Local\\Programs\\Microsoft VS Code\\resources\\app\\extensions\\git\\dist\\askpass-main.js",VSCODE_GIT_ASKPASS_NODE:"C:\\Users\\x5426\\AppData\\Local\\Programs\\Microsoft VS Code\\Code.exe",VSCODE_GIT_IPC_HANDLE:"\\\\.\\pipe\\vscode-git-7af9e1cdba-sock",VSCODE_INJECTION:"1",windir:"C:\\Windows",ZES_ENABLE_SYSMAN:"1"};const q={class:"container-fluid py-4 height-100vh"},ee={class:"card shadow mt-4"},se={class:"card-body container-fluid pt-3"},oe={class:"row"},ae={class:"col"},te={class:"p-0"},ne={class:"m-0"},ie={class:"row f-between-center"},re={class:"col-sm-6 col-xxl-2"},le={class:"dataTables_length",id:"dataTable_length"},de={class:"f-center gap-2"},pe={class:"col-sm-6 col-xxl-3 mt-2 mt-sm-0"},ce={id:"dataTable_filter",class:"dataTables_filter text-end"},me={class:"f-center gap-2"},_e={class:"table-responsive mt-3"},ue={key:0,class:"table table-bordered table-hover",id:"dataTable",width:"100%",cellspacing:"0"},ge={class:"table-light"},Ce=["title"],Pe={class:"text-center"},Se={key:0,class:"fas fa-solid fa-check text-success"},xe={key:1,class:"py-4"},fe={key:2,class:"py-4"},he={class:"row f-between-center mt-2"},Ee={class:"col-sm-6"},De={class:"dataTables_info",id:"dataTable_info",role:"status","aria-live":"polite"},Re={class:"col-sm-6 mt-2 mt-sm-0"},ve={class:"f-md-end-center"},Ae={class:"pagination"},Oe=["onClick"],Te={key:1,class:"page-link"},be={__name:"index",setup(x){const{$swal:f}=$(),m=S(""),n=S(1),u=S(10),h=S(null),t=S(null),g=async()=>{try{const o=await $fetch(`${Z.API_BASE_URL}/dashboard/?page=${n.value}&page_size=${u.value}&search=${m.value}&sort_by=completed_count&sort_order=desc`);t.value=Y(o.users,o.stats,o.pagination,o.updated_at,o.completed_count,"2025-05-01")}catch(o){f.fire({position:"center",icon:"error",title:(o==null?void 0:o.data)||"發生未知錯誤，請稍後重試",showConfirmButton:!1,timer:1500})}},v=()=>{clearTimeout(h.value),h.value=setTimeout(()=>{n.value=1,g()},300)};H(()=>g()),w([n,u],()=>g()),w(m,v);const E=o=>{const e=[];if(o<=5)for(let i=1;i<=o;i++)e.push(i);else if(n.value<=3){for(let i=1;i<=4;i++)e.push(i);e.push("..."),e.push(o)}else if(n.value>=o-2){e.push(1),e.push("...");for(let i=o-3;i<=o;i++)e.push(i)}else e.push(1),e.push("..."),e.push(n.value-1),e.push(n.value),e.push(n.value+1),e.push("..."),e.push(o);return e},C=o=>{n.value=o};return(o,e)=>{var p,i,b,y,M,U,I,F,L,N;return d(),l("div",q,[e[17]||(e[17]=s("h1",{class:"h3 mb-2 text-gray-800"},"Tables",-1)),s("div",ee,[e[16]||(e[16]=s("div",{class:"card-header py-3"},[s("h2",{class:"fs-5 m-0 text-primary"},"每日任務打卡狀況")],-1)),s("div",se,[s("div",oe,[s("div",ae,[s("ol",te,[e[5]||(e[5]=s("li",null,[s("p",{class:"m-0"},"*只要在該日打卡討論串留言就算打卡成功")],-1)),s("li",null,[s("p",ne," *資料更新頻率：一個小時更新一次（最後更新時間： "+_((p=a(t))==null?void 0:p.updatedAt)+"） ",1)])])])]),s("div",ie,[s("div",re,[s("div",le,[s("label",de,[e[7]||(e[7]=A(" Show ")),k(s("select",{name:"dataTable_length","aria-controls":"dataTable",class:"form-control form-control-sm","onUpdate:modelValue":e[0]||(e[0]=r=>W(u)?u.value=r:null),onChange:e[1]||(e[1]=r=>n.value=1)},e[6]||(e[6]=[s("option",{value:"10"},"10",-1),s("option",{value:"25"},"25",-1),s("option",{value:"50"},"50",-1),s("option",{value:"100"},"100",-1)]),544),[[z,a(u)]]),e[8]||(e[8]=A(" entries "))])])]),s("div",pe,[s("div",ce,[s("label",me,[e[9]||(e[9]=A(" Search: ")),k(s("input",{type:"search",class:"form-control form-control-sm",placeholder:"請輸入顯示名稱","aria-controls":"dataTable","onUpdate:modelValue":e[2]||(e[2]=r=>W(m)?m.value=r:null)},null,512),[[X,a(m)]])])])])]),s("div",_e,[((i=a(t))==null?void 0:i.processedUsers.length)>0?(d(),l("table",ue,[s("thead",ge,[s("tr",null,[e[10]||(e[10]=s("th",null,"使用者名稱",-1)),e[11]||(e[11]=s("th",null,"累積打卡天數",-1)),(d(!0),l(D,null,R((b=a(t))==null?void 0:b.dateList,(r,c)=>(d(),l("th",{key:c,title:a(Q)(r)}," Day "+_(c+1),9,Ce))),128))])]),s("tbody",null,[(d(!0),l(D,null,R((y=a(t))==null?void 0:y.processedUsers,({global_name:r,author_id:c,username:P,completed_count:V,days:G})=>(d(),l("tr",{key:c},[s("td",null,_(r)+" ("+_(P)+")",1),s("td",Pe,_(V),1),(d(!0),l(D,null,R(G,(K,j)=>(d(),l("td",{key:j,class:"text-center"},[K?(d(),l("i",Se)):J("",!0)]))),128))]))),128))])])):((M=a(t))==null?void 0:M.processedUsers.length)===0?(d(),l("div",xe,e[12]||(e[12]=[s("h2",{class:"fs-5 fs-lg-2"},"無符合搜尋結果的資料",-1)]))):(d(),l("div",fe,e[13]||(e[13]=[s("h2",{class:"fs-5 fs-lg-2"},"載入中 ...",-1)])))]),s("div",he,[s("div",Ee,[s("div",De,_((U=a(t))!=null&&U.pagination?`Showing ${(a(t).pagination.current_page-1)*a(t).pagination.page_size+1} 
          to ${Math.min(a(t).pagination.current_page*a(t).pagination.page_size,a(t).pagination.total_count)} 
          of ${a(t).pagination.total_count} entries`:"Loading..."),1)]),s("div",Re,[s("div",ve,[s("ul",Ae,[s("li",{class:O(["paginate_button page-item previous",{disabled:a(n)===1}])},[s("a",{href:"#","aria-controls":"dataTable",class:"page-link",onClick:e[3]||(e[3]=T(r=>a(n)>1&&C(a(n)-1),["prevent"]))},e[14]||(e[14]=[s("i",{class:"fas fa-solid fa-angle-left"},null,-1)]))],2),(d(!0),l(D,null,R(E((F=(I=a(t))==null?void 0:I.pagination)==null?void 0:F.total_pages),(r,c)=>(d(),l("li",{class:O(["paginate_button page-item",{active:r===a(n),disabled:r==="..."}]),key:c},[r!=="..."?(d(),l("a",{key:0,href:"#","aria-controls":"dataTable",class:"page-link",onClick:T(P=>C(r),["prevent"])},_(r),9,Oe)):(d(),l("span",Te,"..."))],2))),128)),s("li",{class:O(["paginate_button page-item next",{disabled:a(n)===((N=(L=a(t))==null?void 0:L.pagination)==null?void 0:N.total_pages)}]),id:"dataTable_next"},[s("a",{href:"#","aria-controls":"dataTable",class:"page-link",onClick:e[4]||(e[4]=T(r=>{var c,P;return a(n)<((P=(c=a(t))==null?void 0:c.pagination)==null?void 0:P.total_pages)&&C(a(n)+1)},["prevent"]))},e[15]||(e[15]=[s("i",{class:"fas fa-solid fa-angle-right"},null,-1)]))],2)])])])])])])])}}},Me=B(be,[["__scopeId","data-v-ad7ffc85"]]);export{Me as default};
