import{_ as M,K as F,S as P,r as E,M as j,x as K,c as l,a,j as O,t as p,k as d,Q as m,R as g,T,o as n,N as Q,U as W}from"./DtrHG1cz.js";import{u as q}from"./DS7HZrx9.js";function G(b,u,v,y,k="2025-05-01"){const s=new Date(k),c=u.reduce((i,e)=>{const t=new Date(e.date);return t>i?t:i},s),x=Math.floor((c-s)/(1e3*60*60*24))+1,f=Array.from({length:x},(i,e)=>{const t=new Date(s);return t.setDate(s.getDate()+e),t.toISOString().slice(0,10)}),w=b.map(i=>{const e=f.map(t=>{var _;return!!((_=i.presence)!=null&&_[t])});return{author_id:i.author_id,global_name:i.global_name,username:i.username,days:e}});return{dateList:f,processedUsers:w,pagination:v,updatedAt:y}}const H=b=>new Date(b).toLocaleDateString("zh-TW",{year:"numeric",month:"2-digit",day:"2-digit"});var J={API_BASE_URL:"https://4ccf-114-27-206-1.ngrok-free.app/api"};const X={class:"container-fluid py-4 height-100vh"},Y={class:"card shadow mt-4"},Z={class:"card-body container-fluid pt-3"},tt={class:"row"},at={class:"col"},et={class:"p-0"},st={class:"m-0"},ot={class:"table-responsive mt-3"},lt={key:0,class:"table table-bordered table-hover",id:"dataTable",width:"100%",cellspacing:"0"},nt={class:"table-light"},it=["title"],dt={key:0,class:"fas fa-solid fa-check text-success"},rt={key:1,class:"py-4"},ct={class:"row f-between-center mt-2"},ut={class:"col-sm-6"},pt={class:"dataTables_info",id:"dataTable_info",role:"status","aria-live":"polite"},_t={class:"col-sm-6 mt-2 mt-sm-0"},ht={class:"f-md-end-center"},bt={class:"pagination"},vt={class:"paginate_button page-item previous disabled",id:"dataTable_previous"},ft=["disabled"],mt=["onClick"],gt={key:1,class:"page-link"},yt={class:"paginate_button page-item next",id:"dataTable_next"},kt=["disabled"],wt={__name:"index",async setup(b){let u,v;const y=F(),{$swal:k}=P();E();const s=E(1),{data:c,pending:x,refresh:f}=([u,v]=j(()=>q(()=>`/dashboard/?page=${s.value}&page_size=10`,{initialCache:!1,cache:"no-store",baseURL:J.API_BASE_URL,watch:[s],transform:e=>G(e.users,e.stats,e.pagination,e.updated_at,"2025-05-01"),onResponseError({response:e}){const{message:t}=e==null?void 0:e.data;k.fire({position:"center",icon:"error",title:t||"發生未知錯誤，請稍後重試",showConfirmButton:!1,timer:1500})}},"$Da9EyIdlDM")),u=await u,v(),u);K(()=>y.fullPath,()=>{f()});const w=e=>{const t=[];if(e<=5)for(let o=1;o<=e;o++)t.push(o);else if(s.value<=3){for(let o=1;o<=4;o++)t.push(o);t.push("..."),t.push(e)}else if(s.value>=e-2){t.push(1),t.push("...");for(let o=e-3;o<=e;o++)t.push(o)}else t.push(1),t.push("..."),t.push(s.value-1),t.push(s.value),t.push(s.value+1),t.push("..."),t.push(e);return t},i=e=>{s.value=e};return(e,t)=>{var _,o,D,C,S,A,L,B,R,U,V;return n(),l("div",X,[t[9]||(t[9]=a("h1",{class:"h3 mb-2 text-gray-800"},"Tables",-1)),a("div",Y,[t[8]||(t[8]=a("div",{class:"card-header py-3"},[a("h2",{class:"fs-5 m-0 text-primary"},"每日任務打卡狀況")],-1)),a("div",Z,[a("div",tt,[a("div",at,[a("ol",et,[t[2]||(t[2]=a("li",null,[a("p",{class:"m-0"},"*只要在該日打卡討論串留言就算打卡成功")],-1)),a("li",null,[a("p",st," *資料更新頻率：一個小時更新一次（最後更新時間： "+p((_=d(c))==null?void 0:_.updatedAt)+"） ",1)])])])]),t[7]||(t[7]=O('<div class="row f-between-center" data-v-da02b992><div class="col-sm-6 col-xxl-2" data-v-da02b992><div class="dataTables_length" id="dataTable_length" data-v-da02b992><label class="f-center gap-2" data-v-da02b992> Show <select name="dataTable_length" aria-controls="dataTable" class="form-control form-control-sm" data-v-da02b992><option value="10" data-v-da02b992>10</option><option value="25" data-v-da02b992>25</option><option value="50" data-v-da02b992>50</option><option value="100" data-v-da02b992>100</option></select> entries </label></div></div><div class="col-sm-6 col-xxl-3 mt-2 mt-sm-0" data-v-da02b992><div id="dataTable_filter" class="dataTables_filter text-end" data-v-da02b992><label class="f-center gap-2" data-v-da02b992> Search: <input type="search" class="form-control form-control-sm" placeholder="搜尋使用者名稱" aria-controls="dataTable" data-v-da02b992></label></div></div></div>',1)),a("div",ot,[d(c)?(n(),l("table",lt,[a("thead",nt,[a("tr",null,[t[3]||(t[3]=a("th",null,"使用者名稱",-1)),(n(!0),l(m,null,g((o=d(c))==null?void 0:o.dateList,(r,h)=>(n(),l("th",{key:h,title:d(H)(r)}," Day "+p(h+1),9,it))),128))])]),a("tbody",null,[(n(!0),l(m,null,g((D=d(c))==null?void 0:D.processedUsers,({global_name:r,author_id:h,username:$,days:I})=>(n(),l("tr",{key:h},[a("td",null,p(r)+" ("+p($)+")",1),(n(!0),l(m,null,g(I,(N,z)=>(n(),l("td",{key:z,class:"text-center"},[N?(n(),l("i",dt)):Q("",!0)]))),128))]))),128))])])):(n(),l("div",rt,t[4]||(t[4]=[a("h2",{class:"fs-5 fs-lg-2"},"請重新整理頁面",-1)])))]),a("div",ct,[a("div",ut,[a("div",pt," Showing 1 to "+p((S=(C=d(c))==null?void 0:C.pagination)==null?void 0:S.page_size)+" of "+p((L=(A=d(c))==null?void 0:A.pagination)==null?void 0:L.total_count)+" entries ",1)]),a("div",_t,[a("div",ht,[a("ul",bt,[a("li",vt,[a("a",{href:"#","aria-controls":"dataTable",class:"page-link",disabled:d(s)===1,onClick:t[0]||(t[0]=T(r=>i(e.page-1),["prevent"]))},t[5]||(t[5]=[a("i",{class:"fas fa-solid fa-angle-left"},null,-1)]),8,ft)]),(n(!0),l(m,null,g(w((R=(B=d(c))==null?void 0:B.pagination)==null?void 0:R.total_pages),(r,h)=>(n(),l("li",{class:W(["paginate_button page-item",{active:r===d(s),disabled:r==="..."}]),key:h},[r!=="..."?(n(),l("a",{key:0,href:"#","aria-controls":"dataTable",class:"page-link",onClick:T($=>i(r),["prevent"])},p(r),9,mt)):(n(),l("span",gt,"..."))],2))),128)),a("li",yt,[a("a",{href:"#","aria-controls":"dataTable",class:"page-link",disabled:d(s)===((V=(U=d(c))==null?void 0:U.pagination)==null?void 0:V.total_pages),onClick:t[1]||(t[1]=T(r=>i(e.page+1),["prevent"]))},t[6]||(t[6]=[a("i",{class:"fas fa-solid fa-angle-right"},null,-1)]),8,kt)])])])])])])])])}}},Dt=M(wt,[["__scopeId","data-v-da02b992"]]);export{Dt as default};
